import { Component, ViewChild } from '@angular/core';
import { Subject } from 'rxjs';
import { PoToasterBaseComponent } from './po-toaster-base.component';
import { PoToasterType } from './po-toaster-type.enum';
import { PoToasterOrientation } from './po-toaster-orientation.enum';
import * as i0 from "@angular/core";
import * as i1 from "../../po-language/po-language.service";
import * as i2 from "@angular/common";
const _c0 = ["toaster"];
function PoToasterComponent_div_6_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 7);
    i0.ɵɵlistener("click", function PoToasterComponent_div_6_Template_div_click_0_listener($event) { i0.ɵɵrestoreView(_r3); const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.poToasterAction($event); });
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", ctx_r1.actionLabel, " ");
} }
/**
 * @docsPrivate
 *
 * @docsExtends PoToasterBaseComponent
 */
export class PoToasterComponent extends PoToasterBaseComponent {
    constructor(languageService, changeDetector, elementeRef, renderer) {
        super();
        this.changeDetector = changeDetector;
        this.elementeRef = elementeRef;
        this.renderer = renderer;
        this.alive = true;
        /* Margem do Toaster referênte à sua orientação e posição*/
        this.margin = 20;
        /* Observable para monitorar o Close to Toaster */
        this.observableOnClose = new Subject();
        /* Posição do Toaster*/
        this.toasterPosition = 'po-toaster-bottom';
    }
    ngOnDestroy() {
        this.alive = false;
    }
    ngAfterViewInit() {
        setTimeout(() => this.renderer.addClass(this.toaster.nativeElement, 'po-toaster-visible'));
    }
    /* Muda a posição do Toaster na tela*/
    changePosition(position) {
        this.elementeRef.nativeElement.style.display = 'table';
        this.margin = 6 + 44 * position + position * 6;
        if (this.orientation === PoToasterOrientation.Top) {
            this.toaster.nativeElement.style.top = this.margin + 'px';
        }
        else {
            this.toaster.nativeElement.style.bottom = this.margin + 'px';
        }
    }
    /* Fecha o componente Toaster */
    close() {
        this.observableOnClose.next(true);
    }
    setFadeOut() {
        this.renderer.removeClass(this.toaster.nativeElement, 'po-toaster-visible');
        this.renderer.addClass(this.toaster.nativeElement, 'po-toaster-invisible');
    }
    /* Configura o Toaster com os atributos passados para ele */
    configToaster(poToaster) {
        this.type = poToaster.type;
        this.message = poToaster.message;
        this.orientation = poToaster.orientation;
        this.position = poToaster.position;
        this.action = poToaster.action;
        this.actionLabel = poToaster.actionLabel;
        this.componentRef = poToaster.componentRef;
        /* Muda a orientação do Toaster */
        if (this.orientation === PoToasterOrientation.Top) {
            this.toasterPosition = 'po-toaster-top';
        }
        /* Muda a posição do Toaster */
        this.changePosition(this.position);
        /* Switch para o tipo de Toaster */
        switch (this.type) {
            case PoToasterType.Error: {
                this.toasterType = 'po-toaster-error';
                this.icon = 'po-icon-warning';
                break;
            }
            case PoToasterType.Information: {
                this.toasterType = 'po-toaster-info';
                this.icon = 'po-icon-info';
                break;
            }
            case PoToasterType.Success: {
                this.toasterType = 'po-toaster-success';
                this.icon = 'po-icon-ok';
                break;
            }
            case PoToasterType.Warning: {
                this.toasterType = 'po-toaster-warning';
                this.icon = 'po-icon-warning';
                break;
            }
        }
        this.changeDetector.detectChanges();
    }
    getIcon() {
        return this.icon;
    }
    getToasterPosition() {
        return this.toasterPosition;
    }
    getToasterType() {
        return this.toasterType;
    }
    onButtonClose(event) {
        event.preventDefault();
        event.stopPropagation();
        if (this.action && !this.actionLabel) {
            this.poToasterAction(event);
        }
        else {
            this.close();
        }
    }
    /* Chama a função passada pelo atributo `action` */
    poToasterAction(event) {
        event.preventDefault();
        event.stopPropagation();
        this.action(this);
    }
}
PoToasterComponent.ɵfac = function PoToasterComponent_Factory(t) { return new (t || PoToasterComponent)(i0.ɵɵdirectiveInject(i1.PoLanguageService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Renderer2)); };
PoToasterComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoToasterComponent, selectors: [["po-toaster"]], viewQuery: function PoToasterComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.toaster = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], decls: 9, vars: 9, consts: [[3, "click"], ["toaster", ""], [1, "po-toaster-icon"], [1, "po-toaster-message"], ["class", "po-toaster-action", 3, "click", 4, "ngIf"], [1, "po-toaster-close", 3, "click"], [1, "po-icon", "po-icon-close"], [1, "po-toaster-action", 3, "click"]], template: function PoToasterComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0, 1);
        i0.ɵɵlistener("click", function PoToasterComponent_Template_div_click_0_listener() { return ctx.close(); });
        i0.ɵɵelementStart(2, "div", 2);
        i0.ɵɵelement(3, "span");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "div", 3);
        i0.ɵɵtext(5);
        i0.ɵɵelementEnd();
        i0.ɵɵtemplate(6, PoToasterComponent_div_6_Template, 2, 1, "div", 4);
        i0.ɵɵelementStart(7, "button", 5);
        i0.ɵɵlistener("click", function PoToasterComponent_Template_button_click_7_listener($event) { return ctx.onButtonClose($event); });
        i0.ɵɵelement(8, "span", 6);
        i0.ɵɵelementEnd()();
    } if (rf & 2) {
        i0.ɵɵclassMapInterpolate2("po-toaster ", ctx.getToasterType(), " ", ctx.getToasterPosition(), " po-clickable");
        i0.ɵɵadvance(3);
        i0.ɵɵclassMapInterpolate1("po-icon ", ctx.getIcon(), "");
        i0.ɵɵadvance(2);
        i0.ɵɵtextInterpolate(ctx.message);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.action && ctx.actionLabel);
    } }, directives: [i2.NgIf], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoToasterComponent, [{
        type: Component,
        args: [{ selector: 'po-toaster', template: "<div #toaster class=\"po-toaster {{ getToasterType() }} {{ getToasterPosition() }} po-clickable\" (click)=\"close()\">\n  <div class=\"po-toaster-icon\">\n    <span class=\"po-icon {{ getIcon() }}\"></span>\n  </div>\n\n  <div class=\"po-toaster-message\">{{ message }}</div>\n\n  <div *ngIf=\"action && actionLabel\" (click)=\"poToasterAction($event)\" class=\"po-toaster-action\">\n    {{ actionLabel }}\n  </div>\n\n  <button class=\"po-toaster-close\" (click)=\"onButtonClose($event)\">\n    <span class=\"po-icon po-icon-close\"></span>\n  </button>\n</div>\n" }]
    }], function () { return [{ type: i1.PoLanguageService }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Renderer2 }]; }, { toaster: [{
            type: ViewChild,
            args: ['toaster']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tdG9hc3Rlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy91aS9zcmMvbGliL3NlcnZpY2VzL3BvLW5vdGlmaWNhdGlvbi9wby10b2FzdGVyL3BvLXRvYXN0ZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9zZXJ2aWNlcy9wby1ub3RpZmljYXRpb24vcG8tdG9hc3Rlci9wby10b2FzdGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCxTQUFTLEVBSVQsU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFNL0IsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFckUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7Ozs7O0lDWm5FLDhCQUErRjtJQUE1RCxrS0FBUyw4QkFBdUIsSUFBQztJQUNsRSxZQUNGO0lBQUEsaUJBQU07OztJQURKLGVBQ0Y7SUFERSxtREFDRjs7QURZRjs7OztHQUlHO0FBS0gsTUFBTSxPQUFPLGtCQUFtQixTQUFRLHNCQUFzQjtJQWU1RCxZQUNFLGVBQWtDLEVBQzNCLGNBQWlDLEVBQ2hDLFdBQXdCLEVBQ3hCLFFBQW9CO1FBRTVCLEtBQUssRUFBRSxDQUFDO1FBSkQsbUJBQWMsR0FBZCxjQUFjLENBQW1CO1FBQ2hDLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ3hCLGFBQVEsR0FBUixRQUFRLENBQVk7UUFoQjlCLFVBQUssR0FBWSxJQUFJLENBQUM7UUFHdEIsMkRBQTJEO1FBQ25ELFdBQU0sR0FBVyxFQUFFLENBQUM7UUFDNUIsa0RBQWtEO1FB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LGlDQUFrSDtRQUFsQiw0RkFBUyxXQUFPLElBQUM7UUFDL0csOEJBQTZCO1FBQzNCLHVCQUE2QztRQUMvQyxpQkFBTTtRQUVOLDhCQUFnQztRQUFBLFlBQWE7UUFBQSxpQkFBTTtRQUVuRCxtRUFFTTtRQUVOLGlDQUFpRTtRQUFoQyxxR0FBUyx5QkFBcUIsSUFBQztRQUM5RCwwQkFBMkM7UUFDN0MsaUJBQVMsRUFBQTs7UUFiRyw4R0FBaUY7UUFFckYsZUFBK0I7UUFBL0Isd0RBQStCO1FBR1AsZUFBYTtRQUFiLGlDQUFhO1FBRXZDLGVBQTJCO1FBQTNCLG9EQUEyQjs7dUZEdUJ0QixrQkFBa0I7Y0FKOUIsU0FBUzsyQkFDRSxZQUFZO3FKQUtBLE9BQU87a0JBQTVCLFNBQVM7bUJBQUMsU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIE9uRGVzdHJveSxcbiAgUmVuZGVyZXIyLFxuICBWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgcG9Mb2NhbGVEZWZhdWx0IH0gZnJvbSAnLi4vLi4vcG8tbGFuZ3VhZ2UvcG8tbGFuZ3VhZ2UuY29uc3RhbnQnO1xuXG5pbXBvcnQgeyBQb0xhbmd1YWdlU2VydmljZSB9IGZyb20gJy4uLy4uL3BvLWxhbmd1YWdlL3BvLWxhbmd1YWdlLnNlcnZpY2UnO1xuXG5pbXBvcnQgeyBQb1RvYXN0ZXJCYXNlQ29tcG9uZW50IH0gZnJvbSAnLi9wby10b2FzdGVyLWJhc2UuY29tcG9uZW50JztcbmltcG9ydCB7IFBvVG9hc3RlciB9IGZyb20gJy4vcG8tdG9hc3Rlci5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9Ub2FzdGVyVHlwZSB9IGZyb20gJy4vcG8tdG9hc3Rlci10eXBlLmVudW0nO1xuaW1wb3J0IHsgUG9Ub2FzdGVyT3JpZW50YXRpb24gfSBmcm9tICcuL3BvLXRvYXN0ZXItb3JpZW50YXRpb24uZW51bSc7XG5cbi8qKlxuICogQGRvY3NQcml2YXRlXG4gKlxuICogQGRvY3NFeHRlbmRzIFBvVG9hc3RlckJhc2VDb21wb25lbnRcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncG8tdG9hc3RlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9wby10b2FzdGVyLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBQb1RvYXN0ZXJDb21wb25lbnQgZXh0ZW5kcyBQb1RvYXN0ZXJCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgLyogQ29tcG9uZW50ZSB0b2FzdGVyICovXG4gIEBWaWV3Q2hpbGQoJ3RvYXN0ZXInKSB0b2FzdGVyOiBFbGVtZW50UmVmO1xuICBhbGl2ZTogYm9vbGVhbiA9IHRydWU7XG4gIC8qIMONY29uZSBkbyBUb2FzdGVyICovXG4gIHByaXZhdGUgaWNvbjogc3RyaW5nO1xuICAvKiBNYXJnZW0gZG8gVG9hc3RlciByZWZlcsOqbnRlIMOgIHN1YSBvcmllbnRhw6fDo28gZSBwb3Npw6fDo28qL1xuICBwcml2YXRlIG1hcmdpbjogbnVtYmVyID0gMjA7XG4gIC8qIE9ic2VydmFibGUgcGFyYSBtb25pdG9yYXIgbyBDbG9zZSB0byBUb2FzdGVyICovXG4gIHByaXZhdGUgb2JzZXJ2YWJsZU9uQ2xvc2UgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gIC8qIFBvc2nDp8OjbyBkbyBUb2FzdGVyKi9cbiAgcHJpdmF0ZSB0b2FzdGVyUG9zaXRpb246IHN0cmluZyA9ICdwby10b2FzdGVyLWJvdHRvbSc7XG4gIC8qIFRpcG8gZG8gVG9hc3RlciAqL1xuICBwcml2YXRlIHRvYXN0ZXJUeXBlOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgbGFuZ3VhZ2VTZXJ2aWNlOiBQb0xhbmd1YWdlU2VydmljZSxcbiAgICBwdWJsaWMgY2hhbmdlRGV0ZWN0b3I6IENoYW5nZURldGVjdG9yUmVmLFxuICAgIHByaXZhdGUgZWxlbWVudGVSZWY/OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgcmVuZGVyZXI/OiBSZW5kZXJlcjJcbiAgKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuYWxpdmUgPSBmYWxzZTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQsICdwby10b2FzdGVyLXZpc2libGUnKSk7XG4gIH1cblxuICAvKiBNdWRhIGEgcG9zacOnw6NvIGRvIFRvYXN0ZXIgbmEgdGVsYSovXG4gIGNoYW5nZVBvc2l0aW9uKHBvc2l0aW9uOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmVsZW1lbnRlUmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICd0YWJsZSc7XG5cbiAgICB0aGlzLm1hcmdpbiA9IDYgKyA0NCAqIHBvc2l0aW9uICsgcG9zaXRpb24gKiA2O1xuXG4gICAgaWYgKHRoaXMub3JpZW50YXRpb24gPT09IFBvVG9hc3Rlck9yaWVudGF0aW9uLlRvcCkge1xuICAgICAgdGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gdGhpcy5tYXJnaW4gKyAncHgnO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRvYXN0ZXIubmF0aXZlRWxlbWVudC5zdHlsZS5ib3R0b20gPSB0aGlzLm1hcmdpbiArICdweCc7XG4gICAgfVxuICB9XG5cbiAgLyogRmVjaGEgbyBjb21wb25lbnRlIFRvYXN0ZXIgKi9cbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5vYnNlcnZhYmxlT25DbG9zZS5uZXh0KHRydWUpO1xuICB9XG5cbiAgc2V0RmFkZU91dCgpIHtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMudG9hc3Rlci5uYXRpdmVFbGVtZW50LCAncG8tdG9hc3Rlci12aXNpYmxlJyk7XG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnRvYXN0ZXIubmF0aXZlRWxlbWVudCwgJ3BvLXRvYXN0ZXItaW52aXNpYmxlJyk7XG4gIH1cblxuICAvKiBDb25maWd1cmEgbyBUb2FzdGVyIGNvbSBvcyBhdHJpYnV0b3MgcGFzc2Fkb3MgcGFyYSBlbGUgKi9cbiAgY29uZmlnVG9hc3Rlcihwb1RvYXN0ZXI6IFBvVG9hc3Rlcikge1xuICAgIHRoaXMudHlwZSA9IHBvVG9hc3Rlci50eXBlO1xuICAgIHRoaXMubWVzc2FnZSA9IHBvVG9hc3Rlci5tZXNzYWdlO1xuICAgIHRoaXMub3JpZW50YXRpb24gPSBwb1RvYXN0ZXIub3JpZW50YXRpb247XG4gICAgdGhpcy5wb3NpdGlvbiA9IHBvVG9hc3Rlci5wb3NpdGlvbjtcbiAgICB0aGlzLmFjdGlvbiA9IHBvVG9hc3Rlci5hY3Rpb247XG4gICAgdGhpcy5hY3Rpb25MYWJlbCA9IHBvVG9hc3Rlci5hY3Rpb25MYWJlbDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZiA9IHBvVG9hc3Rlci5jb21wb25lbnRSZWY7XG5cbiAgICAvKiBNdWRhIGEgb3JpZW50YcOnw6NvIGRvIFRvYXN0ZXIgKi9cbiAgICBpZiAodGhpcy5vcmllbnRhdGlvbiA9PT0gUG9Ub2FzdGVyT3JpZW50YXRpb24uVG9wKSB7XG4gICAgICB0aGlzLnRvYXN0ZXJQb3NpdGlvbiA9ICdwby10b2FzdGVyLXRvcCc7XG4gICAgfVxuXG4gICAgLyogTXVkYSBhIHBvc2nDp8OjbyBkbyBUb2FzdGVyICovXG4gICAgdGhpcy5jaGFuZ2VQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTtcblxuICAgIC8qIFN3aXRjaCBwYXJhIG8gdGlwbyBkZSBUb2FzdGVyICovXG4gICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcbiAgICAgIGNhc2UgUG9Ub2FzdGVyVHlwZS5FcnJvcjoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItZXJyb3InO1xuICAgICAgICB0aGlzLmljb24gPSAncG8taWNvbi13YXJuaW5nJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuSW5mb3JtYXRpb246IHtcbiAgICAgICAgdGhpcy50b2FzdGVyVHlwZSA9ICdwby10b2FzdGVyLWluZm8nO1xuICAgICAgICB0aGlzLmljb24gPSAncG8taWNvbi1pbmZvJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuU3VjY2Vzczoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItc3VjY2Vzcyc7XG4gICAgICAgIHRoaXMuaWNvbiA9ICdwby1pY29uLW9rJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuV2FybmluZzoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItd2FybmluZyc7XG4gICAgICAgIHRoaXMuaWNvbiA9ICdwby1pY29uLXdhcm5pbmcnO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIGdldEljb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaWNvbjtcbiAgfVxuXG4gIGdldFRvYXN0ZXJQb3NpdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy50b2FzdGVyUG9zaXRpb247XG4gIH1cblxuICBnZXRUb2FzdGVyVHlwZSgpIHtcbiAgICByZXR1cm4gdGhpcy50b2FzdGVyVHlwZTtcbiAgfVxuXG4gIG9uQnV0dG9uQ2xvc2UoZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgaWYgKHRoaXMuYWN0aW9uICYmICF0aGlzLmFjdGlvbkxhYmVsKSB7XG4gICAgICB0aGlzLnBvVG9hc3RlckFjdGlvbihldmVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICAvKiBDaGFtYSBhIGZ1bsOnw6NvIHBhc3NhZGEgcGVsbyBhdHJpYnV0byBgYWN0aW9uYCAqL1xuICBwb1RvYXN0ZXJBY3Rpb24oZXZlbnQpOiB2b2lkIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgdGhpcy5hY3Rpb24odGhpcyk7XG4gIH1cbn1cbiIsIjxkaXYgI3RvYXN0ZXIgY2xhc3M9XCJwby10b2FzdGVyIHt7IGdldFRvYXN0ZXJUeXBlKCkgfX0ge3sgZ2V0VG9hc3RlclBvc2l0aW9uKCkgfX0gcG8tY2xpY2thYmxlXCIgKGNsaWNrKT1cImNsb3NlKClcIj5cbiAgPGRpdiBjbGFzcz1cInBvLXRvYXN0ZXItaWNvblwiPlxuICAgIDxzcGFuIGNsYXNzPVwicG8taWNvbiB7eyBnZXRJY29uKCkgfX1cIj48L3NwYW4+XG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJwby10b2FzdGVyLW1lc3NhZ2VcIj57eyBtZXNzYWdlIH19PC9kaXY+XG5cbiAgPGRpdiAqbmdJZj1cImFjdGlvbiAmJiBhY3Rpb25MYWJlbFwiIChjbGljayk9XCJwb1RvYXN0ZXJBY3Rpb24oJGV2ZW50KVwiIGNsYXNzPVwicG8tdG9hc3Rlci1hY3Rpb25cIj5cbiAgICB7eyBhY3Rpb25MYWJlbCB9fVxuICA8L2Rpdj5cblxuICA8YnV0dG9uIGNsYXNzPVwicG8tdG9hc3Rlci1jbG9zZVwiIChjbGljayk9XCJvbkJ1dHRvbkNsb3NlKCRldmVudClcIj5cbiAgICA8c3BhbiBjbGFzcz1cInBvLWljb24gcG8taWNvbi1jbG9zZVwiPjwvc3Bhbj5cbiAgPC9idXR0b24+XG48L2Rpdj5cbiJdfQ==